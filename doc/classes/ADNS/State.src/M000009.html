<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>
<head>
  <title>submit (ADNS::State)</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <link rel="stylesheet" href="../../.././rdoc-style.css" type="text/css" media="screen" />
</head>
<body class="standalone-code">
  <pre>/*
 * call-seq: submit(domain, type[, qflags]) =&gt; ADNS::Query instance
 *
 * Submit asynchronous request to resolve domain &lt;domain&gt; of record type &lt;type&gt; using optional query flags &lt;qflags&gt;.
 */
static VALUE cState_submit(int argc, VALUE argv[], VALUE self)
{
        rb_adns_query_t *rb_adq_r = ALLOC(rb_adns_query_t);
    const char *owner;
    adns_rrtype type;
        adns_queryflags qflags = adns_qf_owner;
        VALUE query; /* return instance */
        int ecode;
    
    Data_Get_Struct(self, rb_adns_state_t, rb_adq_r-&gt;rb_ads_r);
        if (argc &lt; 2)
                rb_raise(rb_eArgError, &quot;wrong number of arguments (%d for 2)&quot;, argc);
        else if (argc &gt; 3)
                rb_raise(rb_eArgError, &quot;excess number of arguments (%d for 3)&quot;, argc);                
    CHECK_TYPE(argv[0], T_STRING); /* DOMAIN */
    CHECK_TYPE(argv[1], T_FIXNUM); /* RR */
    if (argc == 3)
        CHECK_TYPE(argv[2], T_FIXNUM); /* QFlags */
        owner = STR2CSTR(argv[0]);
        type = FIX2INT(argv[1]);
    if (argc == 3)
        qflags |= FIX2INT(argv[2]);
    rb_adq_r-&gt;answer = Qnil;
    query = Data_Wrap_Struct(mADNS__cQuery, cQuery_mark, cQuery_free, rb_adq_r);
    ecode = adns_submit(rb_adq_r-&gt;rb_ads_r-&gt;ads, owner, type, qflags, (void *)query, &amp;rb_adq_r-&gt;adq);
        if (ecode)
                rb_raise(mADNS__eError, strerror(ecode));
        rb_obj_call_init(query, 0, 0);
    return query;
}</pre>
</body>
</html>